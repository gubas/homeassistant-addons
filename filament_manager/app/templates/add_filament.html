% rebase('base.html', title=('√âditer' if edit_mode else 'Ajouter') + ' - Filament Manager', active_page='add')

<div class="page-header">
    <h2>{{('‚úèÔ∏è √âditer' if edit_mode else '‚ûï Ajouter')}} un filament</h2>
</div>

<div class="form-container">
    <form id="filamentForm" method="POST" action="./api/filaments{{('/' + str(filament['id'])) if edit_mode else ''}}">
        <div class="form-group">
            <label for="name">Nom du filament *</label>
            <input type="text" id="name" name="name" value="{{filament['name'] if filament else ''}}"
                placeholder="Ex: PLA Blanc Esun" required>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="type">Type *</label>
                <select id="type" name="type" required>
                    % for t in types:
                    <option value="{{t}}" {{'selected' if filament and filament['type']==t else '' }}>
                        {{t}}
                    </option>
                    % end
                </select>
            </div>

            <div class="form-group">
                <label for="color">Couleur *</label>
                <select id="color" name="color" required>
                    % for c in colors:
                    <option value="{{c}}" {{'selected' if filament and filament['color']==c else '' }}>
                        {{c}}
                    </option>
                    % end
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="weight">Poids initial (g) *</label>
                <input type="number" id="weight" name="weight" min="0" step="0.1"
                    value="{{filament['initial_weight'] if filament else '1000'}}" placeholder="1000" required
                    {{'readonly' if edit_mode else '' }}>
                % if edit_mode:
                <small>Le poids initial ne peut pas √™tre modifi√©</small>
                % end
            </div>

            % if edit_mode:
            <div class="form-group">
                <label for="current_weight">Poids actuel (g) *</label>
                <input type="number" id="current_weight" name="current_weight" min="0" step="0.1"
                    value="{{filament['current_weight']}}" placeholder="800" required>
                <small>Modifiez pour ajuster manuellement le stock</small>
            </div>
            % end
        </div>

        <div class="form-group">
            <label for="cost">Co√ªt (‚Ç¨) *</label>
            <input type="number" id="cost" name="cost" min="0" step="0.01"
                value="{{filament['cost'] if filament else ''}}" placeholder="19.99" required>
        </div>

        <div class="form-group">
            <label for="notes">Notes (optionnel)</label>
            <textarea id="notes" name="notes" rows="3"
                placeholder="Informations suppl√©mentaires...">{{filament['notes'] if filament else ''}}</textarea>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary">
                {{('üíæ Sauvegarder' if edit_mode else '‚ûï Ajouter')}}
            </button>
            <a href="./inventory" class="btn-secondary">‚ùå Annuler</a>
        </div>
    </form>
</div>